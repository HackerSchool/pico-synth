Version 4
SHEET 1 2268 1092
WIRE 1600 112 1600 80
WIRE 1648 112 1648 80
WIRE 1600 176 1600 144
WIRE 1648 176 1648 144
WIRE 1456 192 1344 192
WIRE 880 224 768 224
WIRE 1200 240 1104 240
WIRE 1344 240 1344 192
WIRE 1344 240 1264 240
WIRE 704 272 704 224
WIRE 1392 304 1392 288
WIRE 816 320 816 304
WIRE 1344 320 1344 240
WIRE 1360 320 1344 320
WIRE 768 336 768 224
WIRE 784 336 768 336
WIRE 1456 336 1456 192
WIRE 1456 336 1424 336
WIRE 1536 336 1456 336
WIRE 1648 336 1600 336
WIRE 1776 336 1728 336
WIRE 880 352 880 224
WIRE 880 352 848 352
WIRE 944 352 880 352
WIRE 1040 352 1024 352
WIRE 1104 352 1104 240
WIRE 1104 352 1040 352
WIRE 1120 352 1104 352
WIRE 1280 352 1200 352
WIRE 1360 352 1280 352
WIRE 560 368 544 368
WIRE 704 368 704 352
WIRE 704 368 640 368
WIRE 784 368 704 368
WIRE 1280 400 1280 352
WIRE 816 432 816 384
WIRE 1392 432 1392 368
WIRE 704 480 704 448
WIRE 1280 512 1280 464
WIRE 1040 608 1040 352
WIRE 1264 640 1264 608
WIRE 1568 640 1360 640
WIRE 1360 656 1360 640
WIRE 1360 656 1296 656
WIRE 1168 672 1040 672
WIRE 1232 672 1168 672
WIRE 1360 688 1296 688
WIRE 1616 752 1616 688
WIRE 1168 816 1168 672
WIRE 1360 816 1360 688
WIRE 1360 816 1232 816
WIRE 1168 896 1168 816
WIRE 1360 896 1360 816
WIRE 1360 896 1232 896
WIRE 1168 992 1168 896
WIRE 1232 992 1168 992
WIRE 1360 992 1360 896
WIRE 1360 992 1312 992
FLAG 1600 176 0
FLAG 1648 176 0
FLAG 1648 80 Input
IOPIN 1648 80 In
FLAG 1600 80 +5V
IOPIN 1600 80 In
FLAG 816 432 0
FLAG 704 480 0
FLAG 480 368 Input
IOPIN 480 368 In
FLAG 704 224 +5V
IOPIN 704 224 In
FLAG 816 304 +5V
IOPIN 816 304 In
FLAG 1280 512 0
FLAG 1392 432 0
FLAG 1392 288 +5V
IOPIN 1392 288 In
FLAG 1776 336 Output
IOPIN 1776 336 Out
FLAG 1616 752 0
FLAG 1264 608 0
FLAG 1264 704 +5V
IOPIN 1264 704 In
FLAG 1360 1072 0
SYMBOL MiniSyms4\\voltage- 1600 128 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 5V
SYMBOL MiniSyms4\\voltage- 1648 128 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value PULSE(0 1 0 0.0001 0.0001 0.0015 0.003)
SYMBOL OpAmp\\MCP6002 816 288 R0
SYMATTR InstName U4
SYMBOL res 720 368 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R7
SYMATTR Value 10k
SYMBOL res 720 464 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R8
SYMATTR Value 10k
SYMBOL res 656 352 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 100k
SYMBOL cap 544 352 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C5
SYMATTR Value 100nF
SYMBOL cap 1264 400 R0
SYMATTR InstName C6
SYMATTR Value {cap_filter}
SYMBOL OpAmp\\MCP6002 1392 272 R0
SYMATTR InstName U5
SYMBOL res 1040 336 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value {cutoff}
SYMBOL cap 1600 320 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C7
SYMATTR Value 100nF
SYMBOL res 1744 320 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 1k
SYMBOL res 1216 336 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value {cutoff}
SYMBOL cap 1264 224 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C8
SYMATTR Value {cap_filter}
SYMBOL OpAmp\\MCP6002 1264 736 R180
SYMATTR InstName U1
SYMBOL cap 1024 608 R0
SYMATTR InstName C1
SYMATTR Value 10nF
SYMBOL diode 1232 800 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL diode 1168 912 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D4
SYMATTR Value 1N4148
SYMBOL res 1328 976 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 1k
SYMBOL res 1344 976 R0
SYMATTR InstName R4
SYMATTR Value 1k8
SYMBOL potentiometer 1632 704 R180
SYMATTR InstName U2
SYMATTR Value Rtot=100K wiper=1
TEXT -144 48 Left 2 ;Resonant Low-Pass Filter (PWM controled), \nInspired on: https://benjiaomodular.com/post/2021-04-02-simple-resonant-lpf/\nAnd on Moritz Klein 2-pole VCF\n \nI modified the design to a Sallen-Key 2nd order low pass \n(uses one less opamp)\n \nWe want:\nPWM control of the cutoff frequency \nShould operate on 3.3V or 5V single rail.
TEXT 1952 360 Left 2 !.tran 0 0.1 0.09
TEXT 848 408 Left 0 ;Em vez de MCP6002 podemos usar um \nMCP6004: 4 opamps numa package\nHá no Aliexpress smd barato
TEXT 936 248 Left 1 !.param cutoff=1k
TEXT 936 280 Left 1 !.param cap_filter 10nF
TEXT 1048 408 Left 0 ;R1 and R2 {cutoff} can be \nreplaced with a digital potentiometer\nThe M62429P may work, two channels and\ncheap on Ali. Also has Arduino libs\n \nAlternativa sem ser no Ali é o MCP4631 ou similar
